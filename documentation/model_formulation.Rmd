---
title: "Basic Model formulation"
author: "Florian D. Schneider"
date: "Tuesday, November 18, 2014"
output:
  html_document:
    keep_md: yes
  pdf_document:
    fig_height: 3.5
    fig_width: 4
fontsize: 12pt
geometry: margin=1.4in
csl: ../manuscript/amnat.csl
bibliography: ../manuscript/cas02.bib
---

This document is supposed to develop a model representation of the global mean field as well as pair-approximations of local feed back mechanisms. 

The default form of the differential equation describing vegetation cover is 

$$ \frac{dV}{dt} = G(V) - C(V)g $$

with growth function $G$ and a function $C$ which represents consumption by a herbivore multiplied by the density of herbivores, the livestock rate, $g$. Formally, intrinsic mortality could be included in both terms. In the formulations of @noy-meir75 and @vandekoppel97 it is assumed to be covered by the logistic growth function.

It might become important in the pair-approximation model, where intrinsic plant mortality is included as a proportional loss of mature plants.

```{r, echo=FALSE}
# Default plotting function

defplot <- function(...) plot(..., 
            type = "l", 
            bty = "l", cex = 0.7, las = 1,
            xlim = c(0,1), ylim = c(0,1), 
            xaxs = "i", yaxs = "i", 
            xaxp = c(0,1,2), yaxp = c(0,1,2), 
            xlab = "vegetation cover") 

rho <- seq(0,1,length = 100)

```

## non-spatial models

### logistic growth

If assuming phenomenological logistic growth, the gain in vegetation as a function of present vegetation cover is 

$$ G(V) = rV(1-\frac{V}{K}) \,,$$

with the growth rate, $r$, and the carrying capacity, $K$, decelerating the exponential growth as vegetation cover increases and reducing it to zero if $V \geq K$. Thus, it is a decelerating effect (a negative feed-back) at high vegetation cover. 

```{r, echo=FALSE}

G <- function(P, r = 2, K = 0.9) r*P*(1-P/K)

defplot(rho, G(rho), ylab = "growth")

```

#### mechanistic growth assumptions

The logistic growth model is phenomenological and does not provide a particular ecological explanation, why growth is decelerating to zero with increasing cover. It assumes just some form of global competition leading to a balance of gains and losses at the carrying capacity of the ecosystem. 

Mechanistic explanations can be the limitations by a globally diffuse resource, like water, or the occupation of space and the subsequent limitation of photosynthetic active surface. 

A multitude of such global feedback processes can define the precise shape of the growth function leading to asymetrical or truncated shapes, which could importantly affect the bistability properties of the system [@noy-meir75]. He defines

> The general shape of the growth function relating net growth to plant biomass, $G(V)$, is convex with a single maximum (Fig. 1). The increase in the low-biomass range expresses the increase in photosynthetic capacity with increasing leaf area. The levelling
off to a plateau and the decrease in the higher range expresses self-interference effects (shading, competition); at the point $V = V_\mathrm{max}$ 'maintenance' losses equal photosynthesis and $G = 0$. Vmax is the maximum (stable) biomass in ungrazed vegetation. [...] Of the explicit forms the best known is the logistic [...] but other functions are possible.


```{r, echo=FALSE}
G <- function(P, r = 2.25, K = 0.9) r*P*(1-P/K)

defplot(rho, G(rho), ylab = "growth")

```

**This model is going to be the starting point for the model development**

These are global feed-backs. But local feedbacks also could lead to this deceleration:  
For instance, if plant cover would have a dominantly negative effect on it's surroundings, by depleting nutrients or light, the local neighborhood of a plant cannot be occupied as easy as more remote places. As cover increases and the interspace areas are closing in, the space available for rejuvenation approaches zero. 



#### accelerating growth   

In arid ecosystems, growth would be low at very low cover and accelerate as cover increases, because retention of water and organic matter in the site is fundamentally reduced. This postive feed-back (low cover reduces growth, leading to even lower cover) was discussed by @vandekoppel97 and @rietkerk97 to explain bistability in arid ecosystems.

Starting out from the logistic growth term, we now additionally assume that $r$ is accelerated with cover,

$$ r = r_0 * V^a $$

$$ G(V) = r_0 V^{a+1} (1-\frac{V}{K}) \,,$$


```{r, echo=FALSE}


r <- function(P, r_0 = 2, a = 2) r_0*P^a

defplot(rho, r(rho), ylab = "growth")


G_sig <- function(P, r_0 = 2, a = 2, K = 0.9) r(P, r_0, a)*P*(1-P/K)

defplot(rho, G_sig(rho), ylab = "growth")

```

### functional response

#### linear plant mortality

In the cellular automata model and mean-field approximations of @kefi07, individual plant mortality is a constant rate, which means it is increasing linearly with vegetation cover. 

Plant mortality due to grazing therefore would be described as

$$ C(V) = gVL \,, $$

with the grazing mortality, $g$, per grazer individual multiplied by livestock density, $L$. That is to say, per individual, a constant percentage of cover is eaten. That is, ecologically speaking, not realistic. 


```{r, echo=FALSE}
C <- function(V, L = 10, g = 0.01) (g*V*L)

defplot(rho, C(rho), ylab = "plant mortality")

```

#### constant plant mortality

In fact, when assuming a constant density of herbivores, grazing mortality will certainly saturate at some point, due to limitations of the herbivores handling times. A very parsimonious model would assume that grazing always is defined by this limitation of handling times, even at very low densities. 

Mortality due to grazing,

$$ C(V) = gL \,, $$

thus would be defined as constant, $g$, per grazer individual regardless of the vegetation cover.


```{r, echo=FALSE}
C <- function(V, L = 10, g = 0.01) g * L + V*0

defplot(rho, C(rho), ylab = "plant mortality")

```

Note that grazing mortality can exceed 1, meaning that grazers would exploit more biomass than provided at full cover. Thus stability can be only reached if growth is sufficiently higher and the landscape regenerates itself multiple times per year. 

#### type 2 functional response

In natural systems, however, consumption is defined by saturating functional responses, i.e. at low cover, density dependent mortality defined by search efficiency dominates, but at high cover handling times of the consumer will limit its intake rates. 

Therefore, plant mortality due to grazing should be 

$$ C(V) = \frac{aVL}{1+ahV} \,,$$

with the handling time, $h$ [time per landscape unit], and the search efficiency, $a$ [percent of landscape foraged in per time]. 

```{r, echo=FALSE}
C <- function(V, L = 10, a = 0.6, h = 100) (a*V*L)/(1+a*h*V)

defplot(rho, C(rho), ylab = "plant mortality")

```

Since we are calculating in fractions of landscape, and not in cells, the handling time defines the time a grazer individual would need to handle the entire landscape as readily available fodder. The search time is the percentage of the landscape foraged in over the course of one year.  


#### type 3 functional response

The 

$$ C(V) = \frac{bV^{1+q}}{1+bhV^{1+q}} $$


```{r, echo=FALSE}
C <- function(V, L = 10, a = 0.6, h = 100, q = 1) (a*V^(1+q)*L)/(1+a*h*(V^(1+q)) ) 

defplot(rho, C(rho), ylab = "plant mortality")

```

#### null model

We assume the classic type II functional response plus an intrinsic mortality rate, 

$$ C(V) = m*V + \frac{aVL}{1+ahV} \,,$$


```{r, echo=FALSE}

C <- function(V, m_0 = 0.05, L = 10, a = 0.6, h = 100, q = 0) (m_0 * V) +(a*V^(1+q)*L)/(1+a*h*(V^(1+q)) ) 

defplot(rho, C(rho), ylab = "plant mortality")
abline(a = 0, b = 0.05, lty = 2)
```

**This model is going to be the starting point for our model development**


### bistability

Plotting the growth rate against the different mortality rates shows how the definition of grazing mortality alters our prediction of the steady states of the system. 

Compared to the more realistic non-linear functions, the constant grazing mortality assumption seems to predict both the attractor of the vegetated state and the tipping point much better than the density dependent mortality used in KÃ©fi et al 2007 TPB. In fact, the linear density dependent mortality does not predict bistability at all, given a simple logistic growth function. 


```{r, echo=FALSE}

defplot(rho, G(rho), ylab = "growth", col = "green3")
lines(rho, C(rho, L = 10, a = 0.01, h = 0.00001))
lines(rho, C(rho, L = 25, a = 0.01, h = 0.00001))
lines(rho, C(rho, L = 50, a = 0.01, h = 0.00001))
abline( h = 0.1 )
abline( h = 0.25 )
abline( h = 0.5 )
```


When assuming a type II functional response, the system gains true bistability. 

```{r, echo=FALSE}

defplot(rho, G(rho), ylab = "growth", col = "green3")
lines(rho, C(rho, L = 10))
lines(rho, C(rho, L = 25))
lines(rho, C(rho, L = 50))

```


The type 3 functional response finally predicts the existance of a stable degraded state that is not a desert, i.e. not entirely unvegetated. 

```{r, echo=FALSE}

defplot(rho, G(rho), ylab = "growth", col = "green3")
lines(rho, C(rho, L = 10, q = 1))
lines(rho, C(rho, L = 25, q = 1))
lines(rho, C(rho, L = 50, q = 1))

```



## spatially-explicit models

The models described above were discussed by @noy-meir75 for grazing systems where vegetation is assumed to be of homogeneous distribution, and no spatially-explicit effects are of relevance. 
Refugia or fencing of areas, however, could be considered as spatial effects. 

In arid and semi-arid rangelands, spatial vegetation structure was considered to be of major importance for plant growth and mortality [@rietkerk97; @kefi07]. It generates patterns that act as positive feed-backs on the local scale by providing refugia to grazing and overcome growth limitations at low vegetation cover.

These mechanisms can be implemented in the model by using a pair-approximation approach. 
In numerical simulations $G$ and $C$ can be implemented as the transition rates in a two-state spatial model. 

In the formalism of the pair-approximation model of @kefi07, growth, *i.e.* the total amount of empty cells transitioning into vegetated cells, becomes a complex function of the relative cover of the multiple pairs including a $+$.

In a model with only global effects, the transition probability of indiviual plant death would be

$$ w_{1,0} = C(V)/V = m + \frac{aL}{1+ahV} $$

and the transition probability of individual plant growth

$$ w_{0,1} = G(V)/V = r (1-\frac{V}{K}) \,.$$

### spatially-explicit growth

We implement the accelerating and decelerating features on a local level.

#### accelerating growth

This is assuming that growth rate is enhanced by a local facilitation term similar to the implementation in KÃ©fi et al 2007. The growth rate becomes a function of local vegetation cover $\nu$:

$$ r = r_0 + f \nu \,,$$

with an intrinsic growth rate $r_0$ which determines the probability of growth in absence of local vegetation and the additive facilitation $f$ which gradually determines the enhancement of the growth with an increasing local vegetation cover (maximizing at $\nu = 1$ if the cell has 4 neighbors). 

#### decelerating growth

This is assuming that growth is diminished locally by competition, $c$. This affects carrying capacity rather than growth rate itself.

$$ K = K_0 (1 - c \nu)$$

### spatially-explicit mortality

On the mortality side, we can implement spatially explicit effects on the parameters of the functional response. 

#### accelerating mortality

Mortality becomes enhanced in sparse environments by patches that are attracting grazers. We assume this attractivity, $v$, reduces search times locally. 

$$ a = a_0 * (1 - v * \nu) $$

#### decelerating mortality

Plants in grazed habitats develop protective traits, such as thorns or cushion growth. They thereby provide protected habitat to their direct neighborhood, or share the investments in those traits with their neighbors. Overall grazing mortality thus is reduced through an increase in handling time by associational resistance, $p$

$$ h = h_0 * p * \nu $$



$$ $$

#### decelerating mortality







# References