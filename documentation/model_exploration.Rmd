---
title: "Model exploration"
author: "Florian D. Schneider"
date: "Tuesday, February 25th, 2014"
output:
  pdf_document:
    fig_height: 3
    fig_width: 7
fontsize: 12pt
geometry: margin=1.4in
csl: ../manuscript/amnat.csl
bibliography: ../manuscript/cas02.bib
---

```{r, echo=FALSE}
# ODE solving
library("deSolve")

source("../code/simfunctions.r")

parallel = TRUE
if(parallel) {
# provides parallel backend
library(foreach)
library(doSNOW)

workstation <-  list(host = "162.38.184.118", user = "schneider",
                     rscript = "/usr/lib/R/bin/Rscript",
                     snowlib = "/usr/lib/R/library")

workerlist <- c(rep("localhost", times = 10)) 

cl <- makeSOCKcluster(workerlist, master="162.38.184.88", outfile='out_messages.txt')

registerDoSNOW(cl)

}

# default parameters, global model without spatially-explicit effects

defparms <- list(
    m = 0.05,
    r = 1,
    b = 0.7, 
    K = 0.9, 
    a = 0.6,
    h = 50,
    L = 4, 
    alpha = 0,
    q = 0,
    c = 0,
    f = 0,
    v = 0,
    p = 0
  )


```



# Introduction

The paper departs from a general perception of grazing systems as non-equilibrium systems that are subject to 'dynamic regimes' or 'alternative stable states'.
This means, they can shift their attractor between a vegetated state and a degraded state, if they experience a sufficient perturbation.
The question is how resilience thinking [@folke06; @walker04; @walker12; @folke10]  in managed rangelands in arid and semi-arid ecosystems can be improved. How can the ecosystem be put in a state that is far from the tipping point or the critical thresholds [@may75; @westoby89; @walker81]?

Therefore, this study ims at an integration of local feedback mechanisms in drylands into a graphical population-dynamics framework as developed by @noy-meir75 and extended by @vandekoppel97 and @rietkerk97.
The model identifies how certain mechanisms of vegetation affect the thresholds of catastrophic shifts. This kind of model can be used to inform state-and-transition models that are of high relevance in decisionmaking in the management of rangelands [@westoby89; @briske05; @bestelmeyer03; @briske08].

# alternative stable states due to feedbacks

Ecological systems with non-linear stability are common in nature [@carpenter03; @scheffer01; @gunderson02; @berkes03] and this has enormous impacts on how we analyse and manage those systems. 
As early as 40 years ago, rangelands were identified as a system with non-linear stability, i.e. with alternative stable states [@noy-meir75], from graphical analysis as a simple consumer-resource system.

```{r, echo=FALSE, fig.height = 6}
colpal <- list(mort = c("#000000","#00000040","#00000030","#00000020"), grow = c("#009933","#00993340","#00993330","#00993320") )
rho <- seq(0,1,length = 100)
parms <- defparms

par(mfrow = c(2,2), bty ="n", las = 1 ) 
defplot(rho, G(rho), ylab = "plant mortality/growth", col = colpal$grow[1])
lines(rho, C(rho, set = list(L = 2)), col = colpal$mort[1] )
lines(rho, C(rho, set = list(L = 5)), col = colpal$mort[1] )
lines(rho, C(rho, set = list(L = 8)), col = colpal$mort[1] )

bifurcation(parms, "L", c(0,12))
 
defplot(rho, C(rho), ylab = "plant mortality/growth", col = colpal$mort[1])
lines(rho, G(rho, set = list(b = 0.2) ), col = colpal$grow[1] )
lines(rho, G(rho, set = list(b = 0.5)), col = colpal$grow[1] )
lines(rho, G(rho, set = list(b = 0.8)), col = colpal$grow[1] )

bifurcation(parms, "b", c(0,1))

```

The model is neutral in terms of species and assumes only one relevant type of vegetation and one population of grazer. Noy-meir notes that the model can apply also if there is one plant species that dominates the ecological dynamics of the entire system [@noy-meir75].
We stick to this approach of neglecting species-specific differences. 

## local mechanisms

The graphical approach pursued by @noy-meir75 and @vandekoppel97 is limited to systems that are spatially homogeneous. The functions of vegetation growth and mortality are well defined by only one parameter, vegetation cover. However, in arid and semi-arid ecosystems vegetation cover turns out to be insufficient to describe the state of the ecosystem. Moreover, in a landscape where vegetation grows in aggregated clusters, spatial vegetation structure is important in determining the amount of growth or mortality. This is due to the dependence of the underlying feedback mechanisms on the locally present vegetation, rather than on total cover on the landscape scale. We subsequently describe positive feedback mechanisms that are known to play a role in the determination of growth and mortality in arid and semi-arid rangelands.  

The simplest approach to explore these models is by mean-field approximation, which assumes that spatial structure of vegetation is random and that local cover equals total vegetation cover. This allows the estimation of the steady states of the ecosystem under a given set of parameters, or along a parameter gradient. 

<!-- The spatial extend at which ecological feedback mechanisms act often differ between small local scales and the entire landscape. Previous models have shown that feedbacks acting simultaneously but on different spatial scales emerge and alter the stability properties and spatial structure of the ecosystem [@kefi07a]. -->

```{r, echo=FALSE}

par(mfrow = c(1,2), bty ="n", las = 1 ) 

p1 <- defparms
p1$f = 0.9
p1$b = 0.4

attractor(p1, pairapprox = FALSE, localvals = TRUE)

attractor(p1)

```



### facilitation

The mechanism of facilitation, i.e. the positive effect of one individual or species onto another, is well described in terms of species interaction networks [@bruno09; @kefi12]. Such mechanisms can be species-pair specific but they also play a general abiotic role as the cause of local amelioration of the environmental conditions of the neighborhood of a 'nurse' plant. 


```{r, echo = FALSE}


par(mfrow = c(1,2), bty ="n", las = 1 ) 
parms <- defparms
parms$f = 0.9
parms$b = 0.4

attractor(parms)

bifurcation(parms, "b", c(0,1))
 

```



### local competition

```{r, echo = FALSE}


par(mfrow = c(1,2), bty ="n", las = 1 ) 
parms <- defparms

parms$c = 0.3

attractor(parms)

bifurcation(parms, "b", c(0,1))
 

```

### associational resistance

```{r, echo = FALSE}


par(mfrow = c(1,2), bty ="n", las = 1 ) 
parms <- defparms

parms$L = 8
parms$p = 0.8

attractor(parms)

bifurcation(parms, "L", c(0,12))
 

```


### attractant-decoy

```{r, echo = FALSE}


par(mfrow = c(1,2), bty ="n", las = 1 ) 

parms <- defparms

parms$L = 6
parms$q = 0
parms$v = 0.9

attractor(parms)

bifurcation(parms, "L", c(0,12))
 
```


We conclude that the different kinds of local feedbacks can fundamentally alter the critical thresholds of arid rangelands. Knowing about their relative importance is vital for the management of arid ecosystems under grazing pressure. 

But how can this knowledge be put to practice? The acknowledgement of alternative stable states in rangelands led to the development of state-and-transition models, i.e. descriptions of the ecosystems states and the probabilities and conditions for transitions between them. 


## trajectories 

The mean-field approximation allows us to estimate the alternative states of an ecosystem under a given set of circumstances, it is not very informative about which starting conditions would lead to the one or the other alternative steady state. 

Here, pair-approximation models, that keep track not only of the total vegetation cover but also of the local cover, provide more information and can help to estimate the boundary between the alternative steady state attractors. 

We apply this approach to different scenarios, to discuss under which circumstances an ecosystem might respond positively to a given management condition (e.g. the increase or decrease of livestock)

## spatial structure as state indicator



## Discussion



```{r, echo=FALSE}
if(parallel) {
stopCluster(cl)
}
```

# References